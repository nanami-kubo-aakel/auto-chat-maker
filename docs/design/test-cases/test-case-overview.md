# テストケース概要

## 概要

Auto Chat Makerプロジェクトのテストケース全体の概要と現状を説明します。

## テスト戦略

### テストピラミッド

```
    E2E Tests (少数)
        ↑
  Integration Tests (中程度)
        ↑
   Unit Tests (多数)
```

### テスト分類

1. **単体テスト (Unit Tests)**
   - 個別の関数・クラス・メソッドのテスト
   - モック・スタブを使用した独立したテスト
   - 高速実行が可能

2. **統合テスト (Integration Tests)**
   - 複数のコンポーネント間の連携テスト
   - データベース・外部APIとの統合テスト
   - 実際の依存関係を使用

3. **E2Eテスト (End-to-End Tests)**
   - ユーザー視点での完全なフローテスト
   - UI操作からバックエンド処理まで
   - 実際のブラウザ・APIを使用

## 現在の実装状況

### 実装済みテスト

#### 単体テスト (28テストケース)

| モジュール | テストファイル | テストケース数 | カバレッジ |
|-----------|---------------|---------------|-----------|
| config/settings | test_settings.py | 12 | 100% |
| utils/exceptions | test_exceptions.py | 12 | 100% |
| utils/logger | test_logger.py | 4 | 97% |

#### 統合テスト

- 現在未実装

#### E2Eテスト

- 現在未実装

### テストカバレッジ

**全体カバレッジ: 36%**

| カテゴリ | カバレッジ | 状況 |
|---------|-----------|------|
| 設定管理 | 100% | ✅ 完了 |
| ユーティリティ | 97% | ✅ ほぼ完了 |
| API層 | 0% | ❌ 未実装 |
| ドメイン層 | 0% | ❌ 未実装 |
| インフラ層 | 0% | ❌ 未実装 |
| アプリケーション層 | 0% | ❌ 未実装 |

## テスト実行結果

### 最新実行結果 (2024年12月)

```
=========================================== test session starts ============================================
platform linux -- Python 3.10.12, pytest-8.2.2, pluggy-1.5.0
collected 28 items

tests/unit/config/test_settings.py ............                                                      [ 42%]
tests/unit/utils/test_exceptions.py ............                                                     [ 85%]
tests/unit/utils/test_logger.py ....                                                                 [100%]

====================================== 28 passed, 1 warning in 0.82s =======================================
```

### テスト実行コマンド

```bash
# 全テスト実行
make test

# カバレッジ付きテスト実行
make test-cov

# 特定ディレクトリのテスト実行
pytest tests/unit/config/
pytest tests/unit/utils/

# 詳細出力付きテスト実行
pytest tests/ -v --tb=short
```

## テスト品質指標

### 成功指標

- ✅ **テスト実行成功率**: 100% (28/28)
- ✅ **テスト実行時間**: 0.82秒 (高速)
- ⚠️ **カバレッジ**: 36% (改善必要)
- ❌ **統合テスト**: 未実装
- ❌ **E2Eテスト**: 未実装

### 品質基準

1. **テスト実行時間**: 5分以内
2. **カバレッジ目標**: 80%以上
3. **テスト成功率**: 100%
4. **テスト独立性**: 各テストは独立して実行可能

## 今後の改善計画

### Phase 1: 単体テスト拡充 (優先度: 高)

1. **API層テスト**
   - ルーター・コントローラーのテスト
   - エラーハンドラーのテスト
   - ミドルウェアのテスト

2. **ドメイン層テスト**
   - エンティティのテスト
   - バリューオブジェクトのテスト
   - リポジトリインターフェースのテスト

3. **ユーティリティテスト**
   - ロガーの残り1%カバレッジ

### Phase 2: 統合テスト実装 (優先度: 中)

1. **データベース統合テスト**
   - リポジトリ実装のテスト
   - データベース接続テスト

2. **外部API統合テスト**
   - Microsoft Graph API統合テスト
   - Claude API統合テスト
   - MCPサーバー統合テスト

### Phase 3: E2Eテスト実装 (優先度: 低)

1. **UIテスト**
   - 認証フローテスト
   - チャット操作テスト

2. **API E2Eテスト**
   - 完全なAPIフローテスト
   - Webhook処理テスト

## 関連ドキュメント

- [単体テストケース詳細](./unit-test-cases.md)
- [統合テストケース詳細](./integration-test-cases.md)
- [テストカバレッジ分析](./test-coverage-analysis.md)
- [テスト実装計画](./test-implementation-plan.md)
