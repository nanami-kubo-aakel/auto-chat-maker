# 機能要件

## 主な機能一覧

### 3.1 Teamsチャット検知

* Graph API の `change notifications (webhook)` を使い、Teamsチャットの新着メッセージをリアルタイムに検知
* サブスクリプションの有効期限は定期更新（例：60分ごと）
* 将来的なメール対応を考慮した共通Webhook処理基盤

### 3.2 MCP経由のチャットメッセージ取得

* `ms-365-mcp-server` を通じて、対象チャットメッセージの本文・送信者・スレッド情報を取得
* メッセージタイプ（テキスト、画像、ファイル等）の識別
* 将来的なメール対応を考慮した共通メッセージ処理インターフェース

### 3.3 AIによる返信判断・案生成

* Claude APIなどと接続し、チャットメッセージに対して以下を実施：

  * 返信が必要かどうかを判断
  * 必要と判断された場合は、3件程度の返信案を自然文で生成
  * メッセージの文脈・トーンを考慮した適切な返信案生成
* 将来的なメール対応時も同じAI判定・生成ロジックを再利用

### 3.4 ユーザー通知・UI表示

* ユーザーへ通知（Web/モバイル等）
* 各返信案をボタンまたは一覧形式で提示
* ユーザーが案を選択 or 修正入力できるチャットUIを提供
* チャットとメールの統合管理を考慮したUI設計

### 3.5 MCP経由のチャット返信送信

* ユーザーが確定した返信内容をもとに、MCP経由で `chat.reply` を実行し、Teamsチャットに返信
* 将来的なメール対応時は `mail.reply` に拡張可能な設計

### 3.6 拡張性機能（将来対応）

* メッセージ処理の共通インターフェース
* プラグイン形式での新機能追加
* 設定による機能の有効/無効切り替え

## 更新履歴

- 初版作成: 2024年12月
- Teams対応化: 2024年12月 - Teamsチャットベースに変更、拡張性機能を追加
- 最終更新: 2024年12月
- 更新者: 開発チーム
